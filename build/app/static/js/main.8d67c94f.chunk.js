(this["webpackJsonpmembership-system-demo-webapp"]=this["webpackJsonpmembership-system-demo-webapp"]||[]).push([[0],{509:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(65),s=r.n(c),u=r(9),i=r(361),o=r.n(i),p=(r(299),r(300),r(301),r(302),r(303),r(22)),l=r.n(p),d=r(34),b=r(58),f=r(363),j="/auth/signin",h="/api/auth/signin",v="/api/user/profile",m="/api/team-members",x="/api/workspaces",O=r(174);function k(e){return w.apply(this,arguments)}function w(){return(w=Object(d.a)(l.a.mark((function e(t){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.post(h,{json:t,throwHttpErrors:!1});case 3:return r=e.sent,e.next=6,r.json();case 6:if(n=e.sent,!r.ok){e.next=9;break}return e.abrupt("return",n);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),O.b.error("\u767b\u9646\u5931\u8d25\uff1a"+(null===e.t0||void 0===e.t0?void 0:e.t0.message),5e3);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var y=r(85),g=r(235),E=function(){function e(t,r,n){Object(y.a)(this,e),this.ok=void 0,this.data=void 0,this.error=void 0,this.ok=t,this.data=r,this.error=n}return Object(g.a)(e,null,[{key:"success",value:function(t){return new e(!0,t)}},{key:"failed",value:function(t){return new e(!1,void 0,t)}}]),e}();function T(){return S.apply(this,arguments)}function S(){return(S=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.c)(m);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return F.apply(this,arguments)}function F(){return(F=Object(d.a)(l.a.mark((function e(t){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.post(m,{json:{email:t}});case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",E.success(n));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",E.failed(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function I(e){return R.apply(this,arguments)}function R(){return(R=Object(d.a)(l.a.mark((function e(t){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.delete(m,{json:{id:t}});case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",E.success(n));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",E.failed(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function W(){return z.apply(this,arguments)}function z(){return(z=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.c)(x);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return B.apply(this,arguments)}function B(){return(B=Object(d.a)(l.a.mark((function e(t){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.post(x,{json:{name:t}});case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",E.success(n));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",E.failed(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function M(e){return J.apply(this,arguments)}function J(){return(J=Object(d.a)(l.a.mark((function e(t){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.delete(x,{json:{id:t}});case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",E.success(n));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",E.failed(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}var P=r(153),V=r(163),q=r(164),K=function(e){Object(P.a)(r,e);var t=Object(V.a)(r);function r(e){var n;Object(y.a)(this,r);var a=e.message?e.message:"".concat(e.status,", an unknown error");return(n=t.call(this,"".concat(e.name,": ").concat(a))).status=void 0,n.name=void 0,n.validationErrors=void 0,n.status=e.status,n.name="ApiError",n.validationErrors=e.validationErrors,n}return r}(Object(q.a)(Error)),N=f.a.create({credentials:"include"}).extend({hooks:{beforeError:[function(){var e=Object(d.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.error("ky beforeError: ",t),401!==t.response.status&&403!==t.response.status||document.location.replace(j),e.next=4,t.response.json();case 4:throw r=e.sent,new K(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]}}),Q=r(24),U=function(e){var t=e.children;return Object(Q.jsx)(b.a,{value:{fetcher:function(){var e=Object(d.a)(l.a.mark((function e(t){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.get(t);case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),revalidateOnFocus:!1},children:t})},D=r(149),H=r(57),G=r(97),L=r(524),X=r(525),Y=r(526),Z=r(527),$=r(362),_=r(346),ee=r.n(_)()((function(e,t){return{user:null,init:function(){var r=Object(d.a)(l.a.mark((function r(){var n;return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t().user){r.next=6;break}return r.next=4,te();case 4:(n=r.sent)&&e({user:n});case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),clear:function(){return e({user:null}),!0}}}));function te(){return re.apply(this,arguments)}function re(){return(re=Object(d.a)(l.a.mark((function e(){var t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.get(v);case 3:return t=e.sent,e.next=6,t.json();case 6:if(r=e.sent,!t.ok){e.next=9;break}return e.abrupt("return",r);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),O.b.error("\u83b7\u53d6\u7528\u6237\u6570\u636e\u5931\u8d25 "+(null===e.t0||void 0===e.t0?void 0:e.t0.message));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var ne=r(46),ae=r(523);function ce(){var e=Object(H.g)(),t=ee((function(e){return e.clear})),r=function(){var r=Object(d.a)(l.a.mark((function r(){return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t(),e.replace("/");case 2:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return Object(Q.jsx)("div",{style:{height:"100%",padding:4},children:Object(Q.jsx)(ne.a,{danger:!0,type:"primary",onClick:r,icon:Object(Q.jsx)(ae.a,{}),children:"\u5207\u6362\u7528\u6237"})})}function se(e){var t=e.children,r=Object(H.h)(),a=Object(n.useState)(!0),c=Object(G.a)(a,2),s=c[0],u=c[1],i=ee((function(e){return e.user})),o=ee((function(e){return e.init}));if(Object(n.useEffect)((function(){Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:u(!1);case 3:case"end":return e.stop()}}),e)})))()}),[o]),s)return null;if(!i)return Object(Q.jsx)(H.a,{to:{pathname:j,state:{from:r.pathname}}});var p={path:"/",routes:[{name:"User Profile",icon:Object(Q.jsx)(L.a,{}),path:"/user/profile"},{name:"Team Members",icon:Object(Q.jsx)(X.a,{}),path:"/team-members",hideInMenu:!Object.hasOwn(i.accessTags,"access-team-member")},{name:"Workspace",icon:Object(Q.jsx)(Y.a,{}),path:"/workspaces",hideInMenu:!Object.hasOwn(i.accessTags,"access-workspace")},{name:"Another Service",icon:Object(Q.jsx)(Z.a,{}),path:"/public-service"}]};return Object(Q.jsx)("div",{id:"test-pro-layout",style:{height:"100vh"},children:Object(Q.jsx)($.a,{logo:null,title:"App name",route:p,menu:{defaultOpenAll:!0},location:{pathname:r.pathname},menuItemRender:function(e,t){return Object(Q.jsx)(D.b,{to:e.path,children:t})},rightContentRender:ce,children:t})})}var ue=r(339);function ie(){var e=Object(H.g)(),t=function(){var t=Object(d.a)(l.a.mark((function t(r){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k({username:r,password:r});case 2:t.sent&&e.replace("/user/profile");case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(Q.jsx)("div",{style:{paddingTop:100,backgroundImage:"url(/bg.svg)",backgroundRepeat:"no-repeat",backgroundPosition:" center 110px",backgroundSize:"100%",backgroundColor:"#f0f2f5",height:"100vh"},children:Object(Q.jsx)(ue.a,{title:"Membership System Demo",subTitle:"\u8bf7\u767b\u5f55\u540e\u8bbf\u95ee",submitter:!1,children:["free","basic","pro"].map((function(e){return Object(Q.jsxs)(ne.a,{type:"primary",block:!0,size:"large",style:{marginBottom:20},onClick:function(){return t(e)},children:["\u767b\u5f55\u4e3a ",e.toUpperCase()," \u7528\u6237"]},e)}))})})}function oe(){var e=ee((function(e){return e.user}));return Object(Q.jsxs)("div",{children:["\u5f53\u524d\u7528\u6237\u89d2\u8272\uff1a ",null===e||void 0===e?void 0:e.role,Object(Q.jsx)("br",{}),Object(Q.jsx)("br",{}),"\u6743\u9650\u5217\u8868\uff1a",Object.keys((null===e||void 0===e?void 0:e.accessTags)||{}).map((function(t){return Object(Q.jsxs)("div",{children:[t," = ",null===e||void 0===e?void 0:e.accessTags[t]]},t)}))]})}var pe=r(353),le=r(365),de=r(249),be=r(225),fe=r(520);function je(){var e=Object(b.b)(m),t=e.data,r=e.isValidating,a=e.mutate,c=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,I(t.id);case 3:return o(!1),e.next=6,a();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=Object(n.useState)(!1),u=Object(G.a)(s,2),i=u[0],o=u[1],p=[{title:"Email",dataIndex:"email"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createdAt",valueType:"date"},{title:"\u64cd\u4f5c",width:180,key:"option",valueType:"option",render:function(e,t){return[Object(Q.jsx)(pe.a,{title:"\u786e\u5b9a\u5220\u9664\u5417\uff1f",onConfirm:function(){return c(t)},okButtonProps:{loading:i},children:Object(Q.jsx)(ne.a,{type:"link",children:"\u5220\u9664"})},"delete")]}}];return Object(Q.jsx)(de.a,{search:!1,columns:p,dataSource:t,loading:r,rowKey:"id",pagination:{pageSize:20,showQuickJumper:!1,showSizeChanger:!1},request:function(){return a()},dateFormatter:"string",toolbar:{title:"Team Members"},toolBarRender:function(){return[Object(Q.jsx)(he,{})]}})}function he(){var e=Object(n.useRef)();return Object(Q.jsx)(be.a,{formRef:e,title:"\u6dfb\u52a0\u56e2\u961f\u6210\u5458",trigger:Object(Q.jsxs)(ne.a,{type:"primary",children:[Object(Q.jsx)(le.a,{})," \u6dfb\u52a0\u56e2\u961f\u6210\u5458"]}),width:500,autoFocusFirstInput:!0,submitTimeout:2e3,onVisibleChange:function(t){var r;t||(null===(r=e.current)||void 0===r||r.resetFields())},onFinish:function(){var e=Object(d.a)(l.a.mark((function e(t){var r,n,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t.email);case 2:if(!(c=e.sent).ok){e.next=7;break}return O.b.success("\u6dfb\u52a0\u6210\u5458\u6210\u529f"),T(),e.abrupt("return",!0);case 7:if(!(null===(r=c.error)||void 0===r||null===(n=r.validationErrors)||void 0===n?void 0:n.find((function(e){return"email"===e.name})))){e.next=10;break}return O.b.error("\u6210\u5458\u5df2\u5b58\u5728"),e.abrupt("return",!0);case 10:O.b.error("\u6dfb\u52a0\u6210\u5458\u5931\u8d25 "+(null===(a=c.error)||void 0===a?void 0:a.message));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:Object(Q.jsx)(fe.a,{name:"email",label:"Email",placeholder:"\u8bf7\u8f93\u5165 Email"})})}function ve(){var e=Object(b.b)(x),t=e.data,r=e.isValidating,a=e.mutate,c=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,M(t.id);case 3:return o(!1),e.next=6,a();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=Object(n.useState)(!1),u=Object(G.a)(s,2),i=u[0],o=u[1],p=[{title:"Name",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createdAt",valueType:"date"},{title:"\u64cd\u4f5c",width:180,key:"option",valueType:"option",render:function(e,t){return[Object(Q.jsx)(pe.a,{title:"\u786e\u5b9a\u5220\u9664\u5417\uff1f",onConfirm:function(){return c(t)},okButtonProps:{loading:i},children:Object(Q.jsx)(ne.a,{type:"link",children:"\u5220\u9664"})},"delete")]}}];return Object(Q.jsx)(de.a,{search:!1,columns:p,dataSource:t,loading:r,rowKey:"id",pagination:{pageSize:20,showQuickJumper:!1,showSizeChanger:!1},request:function(){return a()},dateFormatter:"string",toolbar:{title:"Workspaces"},toolBarRender:function(){return[Object(Q.jsx)(me,{})]}})}function me(){var e=Object(n.useRef)();return Object(Q.jsx)(be.a,{formRef:e,title:"\u6dfb\u52a0 Workspace",trigger:Object(Q.jsxs)(ne.a,{type:"primary",children:[Object(Q.jsx)(le.a,{})," \u6dfb\u52a0 Workspace"]}),width:500,autoFocusFirstInput:!0,submitTimeout:2e3,onVisibleChange:function(t){var r;t||(null===(r=e.current)||void 0===r||r.resetFields())},onFinish:function(){var e=Object(d.a)(l.a.mark((function e(t){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t.name);case 2:if(!(n=e.sent).ok){e.next=7;break}return O.b.success("\u6dfb\u52a0 Workspace \u6210\u529f"),W(),e.abrupt("return",!0);case 7:O.b.error("\u6dfb\u52a0 Workspace \u5931\u8d25 "+(null===(r=n.error)||void 0===r?void 0:r.message));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:Object(Q.jsx)(fe.a,{name:"name",label:"Name",placeholder:"\u8bf7\u8f93\u5165 Workspace \u540d\u79f0"})})}function xe(){return Object(Q.jsx)(D.a,{children:Object(Q.jsxs)(H.d,{children:[Object(Q.jsx)(H.b,{path:j,children:Object(Q.jsx)(ie,{})}),Object(Q.jsxs)(se,{children:[Object(Q.jsx)(H.b,{path:"/user/profile",children:Object(Q.jsx)(oe,{})}),Object(Q.jsx)(H.b,{path:"/team-members",children:Object(Q.jsx)(je,{})}),Object(Q.jsx)(H.b,{path:"/workspaces",children:Object(Q.jsx)(ve,{})})]})]})})}var Oe=function(){return Object(Q.jsx)(U,{children:Object(Q.jsx)(u.a,{locale:o.a,children:Object(Q.jsx)(xe,{})})})};s.a.render(Object(Q.jsx)(a.a.StrictMode,{children:Object(Q.jsx)(Oe,{})}),document.getElementById("root"))}},[[509,1,2]]]);
//# sourceMappingURL=main.8d67c94f.chunk.js.map